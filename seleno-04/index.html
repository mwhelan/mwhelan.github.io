
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="last-modified" content="2016-07-17T19:45:42.0020021+01:00" />
    <meta name="keywords" content="" />


    <title>Seleno 0.4 - Michael Whelan - behaviour driven blog</title>

    <link href="/stylesheets/bootstrap.css" rel="stylesheet">
    <link href="/stylesheets/font-awesome/css/font-awesome.css" rel="stylesheet"/>
    <link rel="stylesheet" href="/stylesheets/github.css" type="text/css">
    <link rel="stylesheet" href="/stylesheets/styles.css" type="text/css" />

    <link rel="canonical" href="http://www.michael-whelan.net/seleno-04/" />
</head>
<body>
    <div class="container">
        <!-- row 1: navigation -->
        <div class="row">
            <nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="navigation">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="http://michael-whelan.net/">behaviour driven blog</a>
                    </div>
                    <div class="collapse navbar-collapse" id="collapse">
                        <ul class="nav navbar-nav">
                            <li><a href="http://about.me/michaelwhelan">About</a></li>
                            <li class="dropdown">
                                <a href="#" data-toggle="dropdown">Categories <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                        <li>
                                            <a href="/category/.net" title=".Net">.Net</a>
                                        </li>
                                        <li>
                                            <a href="/category/automated-testing" title="Automated Testing">Automated Testing</a>
                                        </li>
                                        <li>
                                            <a href="/category/azure" title="Azure">Azure</a>
                                        </li>
                                        <li>
                                            <a href="/category/bdd" title="BDD">BDD</a>
                                        </li>
                                        <li>
                                            <a href="/category/bddfy" title="BDDfy">BDDfy</a>
                                        </li>
                                        <li>
                                            <a href="/category/black-box-testing-asp.net-series" title="Black-Box Testing ASP.Net Series">Black-Box Testing ASP.Net Series</a>
                                        </li>
                                        <li>
                                            <a href="/category/general" title="General">General</a>
                                        </li>
                                        <li>
                                            <a href="/category/learning" title="Learning">Learning</a>
                                        </li>
                                        <li>
                                            <a href="/category/programming" title="Programming">Programming</a>
                                        </li>
                                        <li>
                                            <a href="/category/seleno" title="Seleno">Seleno</a>
                                        </li>
                                        <li>
                                            <a href="/category/snow" title="Snow">Snow</a>
                                        </li>
                                        <li>
                                            <a href="/category/sql-server" title="SQL Server">SQL Server</a>
                                        </li>
                                        <li>
                                            <a href="/category/test-data" title="Test Data">Test Data</a>
                                        </li>
                                        <li>
                                            <a href="/category/teststack" title="TestStack">TestStack</a>
                                        </li>
                                        <li>
                                            <a href="/category/visual-studio" title="Visual Studio">Visual Studio</a>
                                        </li>
                                </ul>
                            </li>
                            <li><a href="/archive">Archive</a></li>
                            <li><a href="/feed.xml">RSS</a></li>
                        </ul>

                        <div class="navbar-right">
                            <a class="navbar-custom-button" href="https://twitter.com/mjmwhelan" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://twitter.com']);"><img src="/stylesheets/images/twitter.png"></a>
                            <a class="navbar-custom-button" href="https://github.com/mwhelan" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://github.com']);"><img src="/stylesheets/images/github.png"></a>
                            <a class="navbar-custom-button" href="http://www.linkedin.com/in/mwhelan" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://www.linkedin.com']);"><img src="/stylesheets/images/linkedin.png"></a>
                            <a class="navbar-custom-button" href="https://plus.google.com/u/1/105055485720815974241?rel=me" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://plus.google.com']);"><img src="/stylesheets/images/googleplus.png"></a>
                        </div>
                    </div><!--collapse -->
                </div>
            </nav>
        </div><!--row -->
        <!-- row 2: header -->
        <header class="row">
            <a href="/" title="Home"><img width="60" height="60" src="http://www.gravatar.com/avatar/391e4f217a06e3dfc8976a4b99b79617.png" title="logo"></a>
            <h1 class="blog-title">
                <a href="/" title="Michael Whelan" rel="home">Michael Whelan</a>
            </h1>
            <p class="lead blog-description">behaviour driven blog</p>
        </header>

        <!-- row 3: featured -->
        <div class="row">
            
        </div>

        <!-- row 4: body -->
        <div class="row">
            

<div id="post">
    <h1 class="blog-post-title">Seleno 0.4</h1>

    <div class="blog-post-meta">
        posted on 24 Mar 2013
            | <a class="label label-primary" href="/category/seleno">Seleno</a>
            | <a class="label label-primary" href="/category/teststack">TestStack</a>
    </div>

    <div class="blog-post">
        

        <p><a href="http://teststack.net/">TestStack</a> have just released version 0.4 of <a href="http://teststack.github.com/TestStack.Seleno/">Seleno</a>, our web browser automation framework. It's a pretty big release with lots of bug fixes and enhancements and quite a number of breaking changes as we solidify the core API in preparation for a 1.0 release. We have done extensive refactoring to the core code and internal architecture to improve its testability and to lay the groundwork for new features we are wanting to provide in future releases. While we have strived to keep breaking changes to a minimum, we did choose to make a few as we saw opportunities to improve the API and make the framework easier to use. These changes will greatly reduce as Seleno matures but at this stage we feel it is good to let the API evolve.</p>

<!--excerpt-->

<h2>Breaking Changes</h2>

<p>We have introduced a Breaking Changes text file, which we will update if we ever need to make a breaking change to the API. You can find it <a href="https://github.com/TestStack/TestStack.Seleno/blob/master/BREAKING_CHANGES.md">here</a>. Given the number of breaking changes in this release I strongly recommend that you check it out if you are upgrading from an earlier version!</p>

<h2>New Features</h2>

<h3>SelenoHost / configuration</h3>

<p>One of the breaking changes is that <code>SelenoApplicationRunner</code> has been renamed to <code>SelenoHost</code>. This is the entry point into Seleno that is used to run and configure it. A number of new features have been added to its application configurator (the <code>Action&lt;IAppConfigurator&gt;</code> parameter to the <code>SelenoHost.Run</code> method).</p>

<p>Namely, we have added the following new configuration features:</p>

<ul>
<li>Ability to explicitly specify the initial page for a test and initialise the first page object in one line of code</li>
<li>Ability to specify a Castle.Core logger factory to intercept our internal logging</li>
<li>Ability to more easily specify a non-Firefox web browser</li>
<li>Ability to specify a deployed web application out-of-the-box</li>
<li>Ability to more explicitly specify your MVC routes</li>
<li>Ability to override the <a href="http://blog.mozilla.org/webqa/2012/07/12/webdrivers-implicit-wait-and-deleting-elements/">minimum (implicit) wait timeout inside of Selenium</a></li>
</ul>

<p>For more information about each of these see the following sections.</p>

<h3>Specify the initial page for a test</h3>

<p>There is a new set of methods on <code>SelenoHost</code> to both ensure that tests start on an explicit page (rather than whatever page the last test finished on) as well as instantiate the initial page object:</p>

<pre><code>// Navigate to the homepage of the web application (default) 
// or a URL relative to the root of the web application
SelenoHost.NavigateToInitialPage&lt;TPage&gt;(string relativeUrl = "")
// Navigate to a URL as determined by the referenced controller action
SelenoHost.NavigateToInitialPage&lt;TController, TPage&gt;(Expression&lt;Action&lt;TController&gt;&gt; action)
</code></pre>

<p>Example usages of these new methods:</p>

<pre><code>HomePage page = SelenoHost.NavigateToInitialPage&lt;HomePage&gt;();
WeatherPage weatherPage = SelenoHost.NavigateToInitialPage&lt;WeatherPage&gt;("weather/2643743");
MovieListPage page = SelenoHost.NavigateToInitialPage&lt;MoviesController, MovieListPage&gt;(x =&gt; x.Index());
</code></pre>

<p>In order to ensure all page objects are initialised correctly, we no longer support instantiating Page Objects with the new keyword (i.e. you must use the <code>NavigateToInitialPage</code> method at the start of all your tests).</p>

<p>In order to use the MVC controller action expression overload you need to tell Seleno about your MVC routes so it can generate the URL. See the section below to find out more about how to do that.</p>

<h3>Logging</h3>

<p>We have introduced Castle.Core as a dependency for logging purposes. This provides great flexibility as it is easy to implement its interfaces for whatever logging framework you use and it has built in support for major logging providers such as NLog and log4net.</p>

<p>To configure a logging provider (by default it uses a Null logger) simply add it to the configuration when setting up Seleno. For example:</p>

<pre><code>SelenoHost.Run(..., c =&gt; c.UsingLoggerFactory(new ConsoleFactory()));
</code></pre>

<h3>Support for Internet Explorer and Chrome web drivers</h3>

<p>We have added support for testing with Internet Explorer and Chrome. By default Seleno uses FireFox, but the fluent configuration allows for providing a delegate to create any Selenium RemoteWebDriver. For convenience Seleno provides a factory that produces a default instance of FireFox, Internet Explorer and Chrome webdrivers.</p>

<pre><code>SelenoHost.Run(..., c =&gt; c.WithRemoteWebDriver(BrowserFactory.Chrome));
SelenoHost.Run(..., c =&gt; c.WithRemoteWebDriver(BrowserFactory.InternetExplorer32));
SelenoHost.Run(..., c =&gt; c.WithRemoteWebDriver(BrowserFactory.InternetExplorer64));
</code></pre>

<p>Both Chrome and Internet Explorer require server executables to be present in the test project bin directory in order for their WebDrivers to work. For the moment you need to manually do this, but we will hopefully be able to make this automatic in the future. You can find out more information here:</p>

<ul>
<li><a href="https://code.google.com/p/selenium/wiki/ChromeDriver">Chrome</a>: </li>
<li><a href="https://code.google.com/p/selenium/wiki/InternetExplorerDriver">Internet Explorer</a></li>
</ul>

<h3>Added support for internet applications</h3>

<p>We had a Seleno user get in touch with us to ask how she could test a deployed website, rather than a Visual Studio project. Seleno could already achieve that with the <code>WithWebServer</code> configuration method, but we thought it was a useful scenario to support out of the box. To test deployed applications you just need to use the <code>InternetWebServer</code> class in the configuration method and provide the base URL for the website.</p>

<pre><code>SelenoHost.Run(..., c =&gt; c.WithWebServer(new InternetWebServer("http://www.bbc.co.uk")));
</code></pre>

<h3>Specifying MVC routes</h3>

<p>Previously Seleno used the global <code>RouteTable.Routes</code> object when determining the URLs for MVC routes. We didn't like this because using the global object might affect other code you have running your test assembly. Furthermore, providing a configuration method to specify the routes is more in keeping with how the rest of Seleno is globally configured and is thus more discoverable to new users. To use the configuration you need to use the new <code>WithRouteConfig</code> method:</p>

<pre><code>SelenoHost.Run(..., c =&gt; c.WithRouteConfig(RouteConfig.RegisterRoutes));
</code></pre>

<h3>Overriding minimum (implicit) wait timeout</h3>

<p>When looking for an element on the page that you know has a likelihood of not being present it can be really annoying to see the test hang for 10 seconds while the Selenium Driver waits for its implicit timeout. There is a way to override this timeout, so we thought we would give you the flexibility to easily accomplish this to give you more control. This, combined with the fact that all Seleno methods that might need to wait have an optional <code>maxWait</code> parameter, gives you a lot of flexibility to tweak your tests to be more reliable, but also as fast as possible. You can change from the default 10s implicit timeout by using the new <code>WithMinimumWaitTimeoutOf</code> configuration method:</p>

<pre><code>SelenoHost.Run(..., c =&gt; c.WithMinimumWaitTimeoutOf(TimeSpan.FromSeconds(2)));
</code></pre>

<h3>Continuous Integration support</h3>

<p>Previously, there were problems running Seleno tests in TeamCity (in particular if you had dotCover code coverage running) whereby the test run would hang indefinitely. These problems have been resolved and we can now comfortably say that TeamCity (and by association other CI servers) are supported for Seleno. In fact, we have a TeamCity server that builds Seleno and publishes it to NuGet (this includes running a bunch of acceptance tests) so if it breaks in the future we will know!</p>

<h3>HTML Control Model</h3>

<p>One of our main contributors, Franck Theolade, has put a lot of work into an HTML control model which supports all of the <a href="http://www.w3.org/TR/html401/interact/forms.html#h-17.2">W3C form controls</a>. The Page Object design pattern is not limited to modelling whole pages, but can also include modelling parts of a page, such as menus, or even controls, as is the case here. Just like with page objects, the control implementation is responsible for interacting with the page and retrieving and setting its value.</p>

<p>For example you can make use of the controls directly within your page objects by using code like this:</p>

<pre><code>var textboxValue = HtmlControlFor&lt;TextBox&gt;("StringField").Value;
// Or, if you are using strongly-typed view models
var textboxValue = HtmlControlFor&lt;TextBox&gt;(m =&gt; m.StringField).Value;
</code></pre>

<p>The following implementations ship with Seleno 0.4 (and can be used with the <code>HtmlControlFor</code> method):</p>

<ul>
<li>TextBox</li>
<li>TextArea</li>
<li>DropDown</li>
<li>CheckBox</li>
<li>RadioButtonGroup</li>
</ul>

<p>We cannot possibly support every vendor control, so the goal was to support standard controls out-of-the-box and then make the control model easy to extend for custom controls by implementing the IHtmlControl interface. </p>

<pre><code>public interface IHtmlControl
{
    string Id { get; }
    string Name { get; }
    string Title { get; set; }
    bool ReadOnly { get; set; }
    bool Disabled { get; set; }

    TReturn AttributeValueAs&lt;TReturn&gt;(string attributeName);
    void SetAttributeValue&lt;TValue&gt;(string attributeName, TValue value);
}
</code></pre>

<p>The easiest way to do this is to inherit from the <code>HtmlControl</code> abstract class, but if you need more flexibility then you can inherit from the <code>UiComponent</code> class and implement the <code>IHtmlControl</code> interface. To illustrate, here is the TextArea implementation:</p>

<pre><code>public class TextArea : HTMLControl
{
    public string Content
    {
        get
        {
            return Find().Element(By.Id(Id)).GetAttribute("value");
        }
        set
        {
            var scriptToExecute = string.Format(@"$(""#{0}"").text(""{1}"")", Id, value.ToJavaScriptString());
            Execute().ExecuteScript(scriptToExecute);
        }
    }
}
</code></pre>

<p>Common usage scenarios with HTML controls have been catered for by using the new HTML control model internally to provide the following methods within page objects with a strongly-typed view model (i.e. <code>Page&lt;T&gt;</code>):</p>

<ul>
<li><code>Read().</code>
<ul>
<li><code>bool CheckBoxValue&lt;TProperty&gt;(Expression&lt;Func&lt;TViewModel, TProperty&gt;&gt; checkBoxPropertySelector, TimeSpan maxWait = default(TimeSpan))</code></li>
<li><code>string TextboxValue&lt;TProperty&gt;(Expression&lt;Func&lt;TViewModel, TProperty&gt;&gt; textBoxPropertySelector, TimeSpan maxWait = default(TimeSpan))</code></li>
<li><code>string SelectedOptionTextInDropDown&lt;TProperty&gt;(Expression&lt;Func&lt;TViewModel, TProperty&gt;&gt; dropDownSelector, TimeSpan maxWait = default(TimeSpan))</code></li>
<li><code>TProperty SelectedOptionValueInDropDown&lt;TProperty&gt;(Expression&lt;Func&lt;TViewModel, TProperty&gt;&gt; dropDownSelector, TimeSpan maxWait = default(TimeSpan))</code></li>
<li><code>TProperty SelectedButtonInRadioGroup&lt;TProperty&gt;(Expression&lt;Func&lt;TViewModel, TProperty&gt;&gt; radioGroupButtonSelector, TimeSpan maxWait = default(TimeSpan))</code></li>
<li><code>bool HasSelectedRadioButtonInRadioGroup&lt;TProperty&gt;(Expression&lt;Func&lt;TViewModel, TProperty&gt;&gt; radioGroupButtonSelector, TimeSpan maxWait = default(TimeSpan))</code></li>
<li><code>string TextAreaContent(Expression&lt;Func&lt;TViewModel, string&gt;&gt; textAreaPropertySelector, TimeSpan maxWait = default(TimeSpan))</code></li>
</ul></li>
<li><code>Input().</code>
<ul>
<li><code>void ReplaceInputValueWith&lt;TProperty&gt;(Expression&lt;Func&lt;TModel, TProperty&gt;&gt; propertySelector, TProperty inputValue)</code></li>
<li><code>void ReplaceInputValueWith(string inputName, string value)</code></li>
<li><code>void TickCheckbox(Expression&lt;Func&lt;TModel, bool&gt;&gt; propertySelector, bool isTicked)</code></li>
<li><code>void UpdateTextAreaContent(Expression&lt;Func&lt;TModel, string&gt;&gt; textAreaPropertySelector, string content, TimeSpan maxWait = default(TimeSpan))</code></li>
<li><code>void SelectByOptionValueInDropDown&lt;TProperty&gt;(Expression&lt;Func&lt;TModel, TProperty&gt;&gt; dropDownSelector,TProperty optionValue)</code></li>
<li><code>void SelectByOptionTextInDropDown&lt;TProperty&gt;(Expression&lt;Func&lt;TModel, TProperty&gt;&gt; dropDownSelector,string optionText)</code></li>
<li><code>void SelectButtonInRadioGroup&lt;TProperty&gt;(Expression&lt;Func&lt;TModel, TProperty&gt;&gt; radioGroupButtonSelector, TProperty buttonValue)</code></li>
</ul></li>
</ul>

<h2>Internal improvements</h2>

<h3>Continuous Integration</h3>

<p>Since <a href="http://robdmoore.id.au/">Rob Moore</a> joined TestStack he has had a major impact on Seleno. In particular, he has done some very cool things with continuous integration and automated deployments to allow our TeamCity continuous integration server to integrate with our <a href="https://github.com/TestStack/TestStack.Seleno">github repository</a> and to give us the ability to safely, confidently and quickly deploy new packages to NuGet - we are hoping to have a much tighter release cycle for NuGet packages going forward. Many thanks also need to go to <a href="http://jake.ginnivan.net/">Jake Ginnivan</a> for all his help with this given he has graciously set up the CI infrastructure! One really big time saver is that we are now taking advantage of TeamCity's ability to monitor github for pull requests and automatically build and report whether or not it is OK to merge the changes:</p>

<p><img src="/images/image_thumb.png" alt="TeamCity github integration" /></p>

<h3>Inversion of Control</h3>

<p>We have replaced the Funq inversion of control container with Autofac. We are just using it for our internal configuration currently and have not had the need to expose it externally. We use ILMerge so that it is not a dependency when you download the NuGet package. This allows us to manage lifetimes much more easily within the core code and leaves us with a more maintainable code base.</p>

<h3>Public API</h3>

<p>We have tweaked our public API significantly in order to make it less confusing and more intention revealing. This involes setting a lot of classes that contain internal implementations to <code>internal</code>. For a full list, please see the <a href="https://github.com/TestStack/TestStack.Seleno/blob/master/BREAKING_CHANGES.md">BREAKING_CHANGES.md file</a>.</p>

<h3>Extensive test coverage</h3>

<p>Our unit and integration test coverage of the codebase has been significantly improved. This gives us greater confidence n the codebase. We strongly feel that Seleno is "production-ready" now and as such will be swiftly moving towards a 1.0 release.</p>

<h2>Go get it!</h2>

<p>As usual, you can get the latest version of Seleno on <a href="http://www.nuget.org/packages/TestStack.Seleno/">NuGet</a>, or check out our <a href="https://github.com/TestStack/TestStack.Seleno">github repository</a> for the latest source code. Let us know what you think, or if there are any features that you would like to see. Feel free to add an issue or pull request - the more community interaction we get the better we can make Seleno!</p>

    </div>
    
    <div class="blog-post aboutFooter">
        <h3>About Michael Whelan</h3>
        <img style="float:left;padding-right: 1em;" src="http://www.gravatar.com/avatar/391e4f217a06e3dfc8976a4b99b79617.png">
        <p>
            Michael Whelan is a software developer with 20 yearsâ€™ experience in building (and testing!) applications on the Microsoft stack. He is passionate about applying agile development practices, such as TDD and BDD, to agile processes. Michael specializes in ASP.Net MVC but has also worked with WPF. He does open source development with <a href="http://www.teststack.net/">TestStack</a> to learn from great developers. 
        </p>
    </div>
    
    <!-- Add this toolbox-->
    <div class="row addThis">
        <div class="addthis_toolbox addthis_default_style row pull-right" style="margin:10px">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
            <a class="addthis_button_linkedin_counter"></a>
            <a class="addthis_counter addthis_pill_style"></a>
        </div>
    </div>
    
    <!-- Disqus Comments -->
    <div class="row">
        <div id="disqus_thread"></div>
<script>
    var reset_disqus = function(){
        DISQUS.reset({
            reload: true,
            config: function () {
                //this.page.identifier = '';
                this.page.url = 'http://www.michael-whelan.net/seleno-04/';
                //this.page.title = '';
            }
        });
    };

    var disqus_shortname = 'givenwhenthen';
    var disqus_url = 'http://www.michael-whelan.net/seleno-04/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    window.addEventListener('orientationchange', reset_disqus);
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>        
    </div>
    
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-53d54a0e28fe9235"></script>

    <!-- Authorship Google -->
    <a style="display: block; width: 30px; height: 30px; text-indent: -999px; text-decoration: none" href="https://plus.google.com/u/1/105055485720815974241?rel=author">Google</a>
</div>

        </div>

        <hr>

        <footer class="row">
            <p>&copy; 2014 - Powered by <a href="https://github.com/Sandra/Sandra.Snow" rel="generator">Sandra.Snow</a>.</p>
        </footer>
    </div> <!-- /container -->
    <script src="//code.jquery.com/jquery.js"></script>
    <script src="/javascripts/bootstrap.min.js"></script>
    <script src="/javascripts/prettify.js"></script>

    <script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(['_setAccount', 'UA-49651944-1']);
_gaq.push(['_trackPageview']);
        
(function () {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
})();
</script>

<script type='text/javascript'>
        $(function () {
            $("pre code").parent().each(function () {
                if (!$(this).hasClass("prettyprint")) {
                    $(this).addClass("prettyprint");
                    a = true
                }
            });

            prettyPrint();
        });
    </script>
    

    
    <!-- Authorship Google -->
    <a style="display: block; width: 30px; height: 30px; text-indent: -999px; text-decoration: none" href="https://plus.google.com/u/1/105055485720815974241?rel=author">Google</a>
</body>
</html>
